generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model admin {
  id       Int        @id @default(autoincrement())
  name     String     @db.VarChar(45)
  email    String     @db.VarChar(45)
  password String     @db.Text
  products products[]
}

model comments {
  id                   Int      @default(autoincrement())
  name                 String   @db.VarChar(45)
  email                String   @db.VarChar(45)
  comment              String   @db.Text
  Users_id             Int
  Products_id          Int
  Products_admin_id    Int
  Products_Category_id Int
  products             products @relation(fields: [Products_id, Products_admin_id, Products_Category_id], references: [id, admin_id, Category_id])
  users                users    @relation(fields: [Users_id], references: [id])

  @@id([id, Users_id, Products_id, Products_admin_id, Products_Category_id])
  @@index([Products_id, Products_admin_id, Products_Category_id], name: "fk_comments_Products1_idx")
  @@index([Users_id], name: "fk_comments_Users_idx")
}

model category {
  id       Int        @id @default(autoincrement())
  name     String?    @db.VarChar(45)
  state    Int?
  products products[]
}

model order {
  id                 Int                  @default(autoincrement())
  code               Int
  total_price        Decimal              @db.Decimal(3, 0)
  state              Int
  Users_id           Int
  users              users                @relation(fields: [Users_id], references: [id])
  order_has_Products order_has_Products[]

  @@id([id, Users_id])
  @@index([Users_id], name: "fk_Order_Users1_idx")
}

model order_has_Products {
  Order_id             Int
  Products_id          Int
  Products_admin_id    Int
  Products_Category_id Int
  order                order    @relation(fields: [Order_id], references: [id])
  products             products @relation(fields: [Products_id, Products_admin_id, Products_Category_id], references: [id, admin_id, Category_id])

  @@id([Order_id, Products_id, Products_admin_id, Products_Category_id])
  @@index([Order_id], name: "fk_Order_has_Products_Order1_idx")
  @@index([Products_id, Products_admin_id, Products_Category_id], name: "fk_Order_has_Products_Products1_idx")
}

model products {
  id                 Int                  @default(autoincrement())
  name               String               @db.VarChar(70)
  qte                Int
  price              Decimal              @db.Decimal(3, 0)
  admin_id           Int
  Category_id        Int
  category           category             @relation(fields: [Category_id], references: [id])
  admin              admin                @relation(fields: [admin_id], references: [id])
  comments           comments[]
  order_has_Products order_has_Products[]

  @@id([id, admin_id, Category_id])
  @@index([Category_id], name: "fk_Products_Category1_idx")
  @@index([admin_id], name: "fk_Products_admin1_idx")
}

model users {
  id       Int        @id @default(autoincrement())
  name     String     @db.VarChar(45)
  email    String     @db.VarChar(45)
  password String     @db.Text
  role     String     @default("user") @db.VarChar(11)
  phone    String?    @db.VarChar(45)
  comments comments[]
  order    order[]
}
